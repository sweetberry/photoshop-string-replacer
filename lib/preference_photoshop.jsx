//     Preference_photoshop.jsx 1.0.0//     (c) 2015 sweetberry studio.//     Preference_photoshop may be freely distributed under the MIT license.//@include'../lib/underscore.js';//@include'../lib/json2.js';/** * * @param {string} [name] スクリプト名 * @constructor */function Preference ( name ) {  this.name = name || "myBestScript";  this.attr = {};  this.prefJsonKey = app.stringIDToTypeID( "prefJSON" );  //app.eraseCustomOptions( this.name );  try {    var dest = app.getCustomOptions( this.name );    this.attr = JSON.parse( decodeURIComponent( dest.getData( this.prefJsonKey ) ) );  } catch (e) {}}/** * 初期設定を保存 * @param {string} prefName * @param {*} value */Preference.prototype.set = function ( prefName, value ) {  this.attr[prefName] = value;  var attrJSON = encodeURIComponent( JSON.stringify( this.attr ) );  var dest = new ActionDescriptor();  dest.putData( this.prefJsonKey, attrJSON );  app.putCustomOptions( this.name, dest, true );};/** * 初期設定を取得 * もし存在しなかった場合はundefinedを、 * デフォルトが指定されている場合はその値を保存して返す * @param {string} prefName * @param {*} [defaultValue] */Preference.prototype.get = function ( prefName, defaultValue ) {  var res;  try {    res = this.attr[prefName];  } catch (e) {}  if (_.isUndefined( res ) && defaultValue) {    this.set( prefName, defaultValue );    res = defaultValue;  }  return res;};